
.DEFAULT_GOAL := help
.PHONY: help

texdir1 := $$HOME/Education/Courses/DigitaleIntegrierteSchaltungen/AIMS-BasedCourse/AIMS-Book/Ch04-Latches/Figures
texdir2 := $$HOME/Education/Courses/DigitaleIntegrierteSchaltungen/AIMS-BasedCourse/AIMS-Slides/GitICT/Lectures/03b-ModellingII/Figures


# Basename is used to derive the bitwidth specific files with the width parameter.
#   So typically, make is called like this
#   make width=8 all
#   to generate all targets for the 8bit multiplier.

bn1 = pipeline
bn2 = pipelinemac

tdir = $${HOME}/Education/Courses/DigitaleIntegrierteSchaltungen/AIMS-BasedCourse/AIMS-Book/Ch06-RTLDesign/Figures

# This copy command replacement script adds two comment line at the beginning of the file
# to be copied, that give the source file and the time of copying:
cpcmnd = $${HOME}/developments/Verilog-Projects/AIMS-Book-Examples/Scripts/cpanotate.sh

# The variable QFLAG is passed from the environment. if it is -q Yosys runs silently.



all: copy 

compile: $(bn1) $(bn2) 

sim: $(bn1)_tb.vcd $(bn2)_tb.vcd

wave1: $(bn1)_tb.vcd
	gtkwave $<

wave2: $(bn2)_tb.vcd
	gtkwave $<

$(bn1): $(bn1).v $(bn1)_tb.v
	iverilog -o $(bn1) $(bn1).v $(bn1)_tb.v

$(bn2): $(bn2).v $(bn2)_tb.v
	iverilog -o $(bn2) $(bn2).v $(bn2)_tb.v

$(bn1)_tb.vcd: $(bn1)
	vvp $(bn1)

$(bn2)_tb.vcd: $(bn2)
	vvp $(bn2)

copy:
	$(cpcmnd) $(bn1).v $(bn2).v  $(tdir)

clean:
	rm -f *~ $(bn1) $(bn2) $(bn1)_tb.vcd $(bn2)_tb.vcd

